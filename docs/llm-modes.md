# LLM分析モードの切り替え

## 🎛️ 2つのモード

システムは**LLMあり**と**LLMなし**の2つのモードで動作します。

---

## 🤖 AI分析モード（LLMあり）

### 特徴
- **GPT-5 mini**による高精度な分析
- 文体分析、機械翻訳検出が可能
- 総合レポートを自動生成

### コスト
約0.6円/1人（5問）

### 分析内容
✅ 行動パターン（ウィンドウ切り替え、コピー等）  
✅ 文体分析（流暢さ、不自然さ）  
✅ 機械翻訳検出（DeepL/Google翻訳パターン）  
✅ 総合レポート生成  

### 精度
★★★★★

---

## 📊 統計分析モード（LLMなし）

### 特徴
- 行動パターンのみで判定
- 即座に分析完了
- OpenAI APIキー不要

### コスト
**完全無料**

### 分析内容
✅ 行動パターン（ウィンドウ切り替え、コピー等）  
✅ 統計的な異常検知  
❌ 文体分析  
❌ 機械翻訳検出  
❌ LLMレポート  

### 精度
★★★☆☆

---

## 🎯 使い分け

| 用途 | 推奨モード | 理由 |
|:---|:---|:---|
| **本番運用** | 🤖 AI分析 | 高精度が必要 |
| **開発・テスト** | 📊 統計分析 | コスト削減 |
| **デモ** | 🤖 AI分析 | 機能を全て見せられる |
| **大規模利用** | 📊 統計分析 | コスト削減（1000人で480円節約） |

---

## 🔧 切り替え方法

### 方法1: トップページで選択（推奨）

トップページで名前入力後、以下のボタンから選択：

```
┌─────────────┐  ┌─────────────┐
│  🤖 AI分析   │  │ 📊 統計分析  │
│ 高精度(0.6円)│  │  無料(標準)  │
└─────────────┘  └─────────────┘
```

### 方法2: 環境変数で一律設定

全テストに対して一律で設定する場合：

```bash
# .env.local
USE_LLM=false  # 統計分析のみ
```

※ この場合、トップページの選択は無視されます

---

## 📊 リスクスコアの違い

### 同じ行動パターンでの比較例

| 行動 | AI分析 | 統計分析 | 差 |
|:---|:---|:---|:---|
| ウィンドウ11回切り替え | 75% | 70% | +5% |
| コピー3回 | 65% | 55% | +10% |
| ペースト1回 | 80% | 75% | +5% |

**AI分析の方が、文脈を理解して正確に判定できます**

---

## 💰 コスト比較（100人受験の場合）

| モード | 個別分析 | 総合分析 | 合計 |
|:---|:---|:---|:---|
| **AI分析** | 500回 × $0.00064 = $0.32 | 100回 × $0.0008 = $0.08 | **$0.40（約60円）** |
| **統計分析** | $0 | $0 | **無料** |

---

## 🚀 使い方

### ステップ1: モード選択

トップページで「🤖 AI分析」または「📊 統計分析」を選択

### ステップ2: テスト実行

選択したモードがテスト画面右上に表示されます：
- 🤖 AI分析
- 📊 統計分析

### ステップ3: 結果確認

ダッシュボードで結果を確認：
- **AI分析**: LLMレポート付き
- **統計分析**: シンプルなレポート

---

## 🔍 ログでの確認

```bash
# AI分析モード
🤖 LLM分析モード: attempt xxxxx
✅ Analysis completed [LLM] for attempt xxxxx: 75%
🤖 総合分析: LLMモード

# 統計分析モード
📊 統計分析モード（LLMなし）: attempt xxxxx
✅ Analysis completed [統計] for attempt xxxxx: 72%
📊 総合分析: 統計モード（LLMなし）
```

---

これで完璧です！🎯

